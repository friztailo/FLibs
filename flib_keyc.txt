keyC = class("keyC")

local __keys__ = {}

function keyC:initialize(key)
    self.id = #__keys__ + 1
    
    self.__key_name__ = key
    
    self.__pressed__ = false
    
    self.click = function(value) end
    
    self.pressed = function() end
    self.onPressed = function() end
    
    self.released = function() end
    self.onReleased = function() end
    
    self.loop = function(value) end
    
    __keys__[self.id] = self
end

function keyC:getValue() return self.__pressed__ end

hook.add("inputPressed", "__KeyCheck__", function(key)
    for i, k in pairs(__keys__) do
        if input.getKeyName(key) == k.__key_name__ then
            k.pressed()
            k.click(true)
            k.__pressed__ = true 
        end
    end
end)

hook.add("inputReleased", "__KeyCheck__", function(key)
    for i, k in pairs(__keys__) do
        if input.getKeyName(key) == k.__key_name__ then
            k.released()
            k.click(false)
            k.__pressed__ = false 
        end
    end
end)

hook.add("Think", "__KeyCheck__", function()
    for i, k in pairs(__keys__) do
        if k.__pressed__ then k.onPressed() else k.onReleased() end
        k.loop(k.__pressed__)
    end
end)

return keyC
